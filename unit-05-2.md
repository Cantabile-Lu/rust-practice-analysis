### [å¼•ç”¨ä¸å€Ÿç”¨](https://zh.practice.rs/ownership/borrowing.html)

1. ğŸŒŸ

éœ€è¦æ³¨æ„çš„æ˜¯ï¼š

- å¸¸è§„çš„å¼•ç”¨æ˜¯ä¸€ä¸ªæŒ‡é’ˆç±»å‹ï¼ŒæŒ‡å‘äº†å¯¹è±¡å­˜å‚¨çš„å†…å­˜åœ°å€ã€‚
- `println!`ç”¨äºåœ¨ç»ˆç«¯æˆ–æ§åˆ¶å°ä¸Šæ‰“å°æ–‡æœ¬ï¼Œå®ƒæ˜¯`std::fmt`å…¶ä¸­ä¹‹ä¸€çš„å®ï¼Œåœ¨ä½¿ç”¨`println!`æ—¶å¯ä»¥ä½¿ç”¨ç‰¹å®šçš„å‚æ•°è¿›è¡Œæ ¼å¼åŒ–è¾“å‡ºã€‚

```rust
fn main(){
    // é»˜è®¤æ ¼å¼åŒ–
    let a = "Cantabile";
    println!("{}", a); // Cantabile
    // åŒ…å«ç±»å‹ä¿¡æ¯ 
    let a = "Cantabile";
    println!("{:?}", a); // "Cantabile"
    // ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•ç‰¹æ€§æ ¼å¼åŒ–
    let a = 12_i32;
    println!("{:e}", a); // 1.2e1
    // ä½¿ç”¨äºŒè¿›åˆ¶æ ¼å¼åŒ–
    let a = 12_i32;
    println!("{:b}", a); // 1100
    //ä½¿ç”¨åå…­è¿›åˆ¶æ ¼å¼åŒ–
    let a = 42_i32;
    println!("{:x}", a); // 2a
    // ä½¿ç”¨å­˜å‚¨ä½ç½®æ ¼å¼åŒ–
    let a = "Cantabile";
    println!("{:p}", a);//0x7ff69ef1f428   
}
```

æ­£ç¡®ä»£ç å¦‚ä¸‹ï¼š

```rust
fn main() {
    let x = 5;
    // å¡«å†™ç©ºç™½å¤„
-   let p = __;
+   let p = &x; // å¼•ç”¨äº†å˜é‡xåœ¨æ ˆä¸Šçš„å†…å­˜åœ°å€
+   assert_eq!(5, *p);
    println!("x çš„å†…å­˜åœ°å€æ˜¯ {:p}", p); // output: 0x16fa3ac84
 }
```

2. ğŸŒŸ

éœ€è¦æ³¨æ„çš„æ˜¯ï¼š

- å¼•ç”¨è¿‡åï¼Œéœ€è¦ä½¿ç”¨è§£å¼•ç”¨è¿ç®—ç¬¦`*`æ¥è§£å‡ºå¼•ç”¨æ‰€æŒ‡å‘çš„å€¼ã€‚

```rust
fn main() {
    let x = 5;
    let y = &x;
    // åªèƒ½ä¿®æ”¹ä»¥ä¸‹è¡Œ
-   assert_eq!(5, y);
+   assert_eq!(5, *y);
}
```

3. ğŸŒŸ

éœ€è¦æ³¨æ„çš„æ˜¯ï¼š

- å‡½æ•°ç­¾åä¸­åœ¨ç±»å‹å£°æ˜ä¸Šï¼Œå¦‚æœå­˜åœ¨è¿ç®—ç¬¦`&`ï¼Œé‚£ä¹ˆå½“è°ƒç”¨å‡½æ•°æ—¶ï¼Œå¿…é¡»ä½¿ç”¨`&`è¿ç®—ç¬¦å€Ÿç”¨ä¸€ä¸ªå€¼ã€‚

æ­£ç¡®ä»£ç å¦‚ä¸‹

```rust
fn main() {
-   let mut s = String::from("hello, ");
+   let  s = String::from("hello, ");
-   borrow_object(s)
+ 	borrow_object(&mut s)
}
fn borrow_object(s: &String) {}
```

4. ğŸŒŸ

éœ€è¦æ³¨æ„çš„æ˜¯ï¼š

- åˆ›å»ºå¯å˜å¼•ç”¨éœ€è¦ä½¿ç”¨`&mut`ï¼Œå¹¶æ›´æ–°å‡½æ•°ç­¾åä»¥æ¥æ”¶ä¸€ä¸ªå¯å˜å¼•ç”¨ï¼Œè¿™ä¹Ÿéå¸¸æ¸…æ¥šçš„è¡¨æ˜ï¼Œå‡½æ•°å°†æ”¹å˜å®ƒæ‰€å€Ÿç”¨çš„å€¼

```rust
let mut s = String::from("Cantabile");
do_something(&mut s)
fn do_something(s: &mut String){}  
```

æ­£ç¡®ä»£ç å¦‚ä¸‹

```rust
fn main() {
    let mut s = String::from("hello, ");
-   push_str(s)
+ 	push_str(&mut s)
}
fn push_str(s: &mut String) {
    s.push_str("world")
}
```

5.  ğŸŒŸğŸŒŸ

éœ€è¦æ³¨æ„çš„æ˜¯ï¼š

- åˆ›å»ºä¸€ä¸ªå¯å˜å¼•ç”¨æ—¶ï¼Œè¢«å¼•ç”¨çš„å˜é‡æœ¬èº«æ˜¯éœ€è¦å¯å˜çš„ï¼Œå¯å˜å¼•ç”¨ä¸éœ€è¦å†æ¬¡ä½¿ç”¨å…³é”®å­—`mut`è¿›è¡Œæ ‡è®°ã€‚

æ­£ç¡®ä»£ç å¦‚ä¸‹ï¼š

```rust
fn main() {
    let mut s = String::from("hello, ");
-    let p = __;
+    let p = &mut s;
    p.push_str("world");
}
```

6. ğŸŒŸğŸŒŸğŸŒŸ

éœ€è¦æ³¨æ„çš„æ˜¯ï¼š

- `ref`å…³é”®å­—åˆ›å»ºä¸€ä¸ªå¼•ç”¨ç»‘å®šï¼Œå…¶ä¸»è¦ç”¨äºæ¨¡å¼åŒ¹é…`(match)`çš„ä¸Šä¸‹æ–‡ä¸­ã€‚
- ä½¿ç”¨`ref`ä¸`&`éƒ½æ˜¯åˆ›å»ºå¼•ç”¨ï¼Œå¹¶å°†å¼•ç”¨èµ‹å€¼ç»™å˜é‡ï¼Œå®ƒä»¬çš„è¡Œä¸ºæ˜¯ç›¸ä¼¼çš„ï¼Œéƒ½ä¸ä¼šæ”¹å˜æ‰€æœ‰æƒï¼Œ`&`ç”¨äºä¸€èˆ¬çš„èµ‹å€¼å’Œå¼•ç”¨çš„åˆ›å»ºã€‚ 

```rust
fn main() {
    let  value = Some(String::from("Cantabile"));
    match value {
        Some(n) => println!(" {}", x),
        _ => println!("No value"),
    }
    println!("{:?}",value);//Error:  value borrowed here after partial move
}

fn main() {
    let  value = Some(String::from("Cantabile"));
    match value {
        Some(ref n) => println!(" {}", x),
        _ => println!("No value"),
    }
    println!("{:?}",value); // Some("Cantabile")
}

```

æ­£ç¡®ä»£ç å¦‚ä¸‹ï¼š

```rust
fn main() {
    let c = 'ä¸­';
    let r1 = &c;
    // å¡«å†™ç©ºç™½å¤„ï¼Œä½†æ˜¯ä¸è¦ä¿®æ”¹å…¶å®ƒè¡Œçš„ä»£ç 
-   let __ r2 = c; 
+   let ref r2 = c;
    assert_eq!(*r1, *r2);   
    // åˆ¤æ–­ä¸¤ä¸ªå†…å­˜åœ°å€çš„å­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰
    assert_eq!(get_addr(r1),get_addr(r2));
}
// è·å–ä¼ å…¥å¼•ç”¨çš„å†…å­˜åœ°å€çš„å­—ç¬¦ä¸²å½¢å¼
fn get_addr(r: &char) -> String {
    format!("{:p}", r)
}
```

7. ğŸŒŸ

éœ€è¦æ³¨æ„çš„æ˜¯ï¼š

- Rustçš„å€Ÿç”¨è§„åˆ™ç¡®ä¿åœ¨ä»»ä½•ç»™å®šæ—¶é—´åªæœ‰ä¸€ä¸ªå¯å˜å¼•ç”¨æ´»è·ƒåœ¨ç”¨ä¸€æ—¶é—´è¯»å–å’Œå†™å…¥æ•°æ®ï¼Œä»¥é¿å…æ•°æ®ç«äº‰ã€‚

```Rust
    let mut s = String::from("Cantabile");
    let r1 = &mut s;
    println!("{}", r1);
    let r2 = &mut s;
    println!("{}", r2);
```

å¦‚ä¸Šä»£ç ä¸­å¯å˜å¼•ç”¨`r1`åœ¨åç»­æ²¡æœ‰ç»§ç»­ä½¿ç”¨ï¼Œæ‰€ä»¥å¼•ç”¨åœ¨`println`ä¹‹åè¿›è¡Œäº†é‡Šæ”¾ï¼Œ `r1` å’Œ `r2` ä¸ä¼šåŒæ—¶æ´»è·ƒï¼Œå› æ­¤æ²¡æœ‰è¿å Rust çš„å¯å˜å¼•ç”¨è§„åˆ™

Rustä¹Ÿå…è®¸å¤šä¸ªå¯å˜å¼•ç”¨åŒæ—¶å…±å­˜ï¼Œåªè¦å®ƒä»¬æ²¡æœ‰åŒæ—¶è¿›è¡Œå†™å…¥æ“ä½œã€‚

```rust
    let mut s = String::from("Cantabile");
    let r1 = &mut s;
    let r2 = &mut s;
```

æ­£ç¡®ä»£ç å¦‚ä¸‹ï¼š

```rust
fn main() {
    let mut s = String::from("hello");
    let r1 = &mut s;
    let r2 = &mut s;
-   println!("{},{}",r1, r2);// 
+   println!("{},", r2);
}
```

8. ğŸŒŸ é”™è¯¯: ä»ä¸å¯å˜å¯¹è±¡å€Ÿç”¨å¯å˜

éœ€è¦æ³¨æ„çš„æ˜¯ï¼š

- åˆ›å»ºä¸€ä¸ªå¯å˜å¼•ç”¨æ—¶ï¼Œè¢«å¼•ç”¨çš„å˜é‡æœ¬èº«æ˜¯éœ€è¦å¯å˜çš„

æ­£ç¡®ä»£ç å¦‚ä¸‹ï¼š

```rust
fn main() {
-   let  s = String::from("hello, "); 
+   let mut  s = String::from("hello, ");
    borrow_object(&mut s)
}
fn borrow_object(s: &mut String) {}
```

9. ğŸŒŸğŸŒŸ

- ä»å¯å˜å¯¹è±¡å€Ÿç”¨ä¸å¯å˜æ˜¯å¯ä»¥çš„ï¼Œ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ ‡æ˜äº†ä¸å¯å˜å°±ä¸èƒ½å¯¹å€¼æœ‰æ›´æ”¹æ“ä½œã€‚

```rust
fn main() {
    let mut s = String::from("hello, ");
    borrow_object(&s);
    s.push_str("world");
}

fn borrow_object(s: &String) {
+ 	 // s.push_str("world"); // Error
+    println!("{}",s.len()) // success
}
```

10. ğŸŒŸğŸŒŸ

éœ€è¦æ³¨æ„çš„æ˜¯ï¼š

- å¯¹å¯å˜å¼•ç”¨çš„é‡Šæ”¾æ˜¯ç”±å˜é‡ç¦»å¼€ä½œç”¨åŸŸæ¥è§¦å‘çš„ã€‚

æ­£ç¡®ä»£ç å¦‚ä¸‹ï¼š

```rust
fn main() {
    let mut s = String::from("hello, ");
    let r1 = &mut s; // r1 çš„ä½œç”¨åŸŸå¼€å§‹
    r1.push_str("world");
    // r1 çš„ä½œç”¨åŸŸç»“æŸï¼Œr1 çš„å¯å˜å¼•ç”¨è¢«é‡Šæ”¾
    let r2 = &mut s; // r2 çš„ä½œç”¨åŸŸå¼€å§‹
    r2.push_str("!");
    // r2 çš„ä½œç”¨åŸŸç»“æŸï¼Œr2 çš„å¯å˜å¼•ç”¨è¢«é‡Šæ”¾
-   println!("{}",r1);
+   //println!("{}",r2);
}
```

åœ¨å¦‚ä¸Šä»£ç ä¸­`r1`çš„å˜é‡ä½œç”¨åŸŸåœ¨`r1.push_str`ä¹‹åç»“æŸï¼Œ`r1`çš„å¯å˜å¼•ç”¨è¢«é‡Šæ”¾ï¼Œæ‰€ä»¥å¯ä»¥åˆ›å»º`r2`çš„å¯å˜å¼•ç”¨ã€‚

11. ğŸŒŸğŸŒŸ

éœ€è¦æ³¨æ„çš„æ˜¯ï¼š

- ä¸èƒ½åœ¨å¯å˜å¼•ç”¨åˆ›å»ºå’Œä½¿ç”¨ä¹‹é—´åˆ›å»ºæ–°çš„åŒä¸€æ•°æ®å¯å˜å¼•ç”¨ã€‚

æ­£ç¡®ä»£ç å¦‚ä¸‹ï¼š

```rust
fn main() {
    let mut s = String::from("hello, ");
    let r1 = &mut s;
    let r2 = &mut s;
+   println!("{}",r1);
}
```

